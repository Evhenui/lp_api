<template>
  <div>
    <header class="header" ref="header">
      <div class="header__wrapper">
        <AdditionalInfo 
          @getHeightAdditional="getHeightAdditional"
          class="header__additional" 
        />
        <MainInfo
          class="header__main-info"
          :class="{ active: activeScroll }"
          :heightHeader="heightHeader"
        />
        <ModalMenu />
      </div>
    </header>
  </div>
</template>

<script setup>
import AdditionalInfo from '~/modules/header/sections/AdditionalInfo.vue';
import MainInfo from '~/modules/header/sections/MainInfo.vue';
import ModalMenu from '~/modules/header/sections/ModalMenu.vue';
import ModalCatalog from '~/modules/header/sections/ModalCatalog.vue';

const headerPosition = ref(0);
const heightHeader = ref(0);
const activeScroll = ref(false);

const header = ref(null);

function getHeightAdditional(height) {
  headerPosition.value = height;
}

function getHeightHeader() {
  heightHeader.value = header.value.offsetHeight;
}

function stateHeader() {
  if (window.scrollY >= headerPosition.value) {
    activeScroll.value = true;
  } else {
    activeScroll.value = false;
  }
}

onMounted(() => {
  window.addEventListener('scroll', stateHeader);

  getHeightHeader();
  window.addEventListener('resize', getHeightHeader);
  window.addEventListener('scroll', getHeightHeader);
});
</script>

<style lang="scss" scoped>
.header {
  background-color: white;

  &__main-info {
    width: 100%;

    padding: 4px 16px;

    @include bigMobile {
      position: fixed;
      top: 0;
      z-index: 501;
      
      padding: 8px 16px;
    }
    &.active {
      position: fixed;
      top: 0;

      z-index: 501;
    }
  }

  &__additional {
    @include bigMobile {
      display: none;
    }
  }
}
</style>